<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta content="en-us" http-equiv="Content-Language">
	
	<title>Madrid Tree</title>
	<meta name="author" content="Guenter Richter" />
	<meta name="description" content="ixmaps iteractive map to explore airbnb listigs in venice,italy" />
	<meta name="keywords" content="ixmaps,airbnb,inside,listings,map,char,interactice,SVG" />
	<meta name="Resource-type" content="Document" />

	<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="assets/css/jquery.fullPage.css" />
	<link rel="stylesheet" type="text/css" href="index.css" />
    <link href="assets/css/icomoon.css" rel="stylesheet" />    
	<link href="assets/css/font-awesome.min.css" rel="stylesheet" />
	<style type="text/css">

		body {
			-webkit-user-select: none;
			/* Chrome all / Safari all */
			-moz-user-select: none;
			/* Firefox all */
			-ms-user-select: none;
			/* IE 10+ */
			user-select: none;
			/* Likely future */
		}

		.story-body{
			background-color: rgba(255,255,255,0.1);
			color: #444444;
		}
		.shareBtns a {
			color: #ddd;
		}
		.shareIcon {
			font-size: 32px;
		}
		a {
			color: #aaa;
		}
		.footer {
		}
		.footer p {
			background-color: rgba(235,235,235,0.7);
			padding: 0.8em;
		}
		.footer a {
			color: #428bca;
		}
		.inline-legend{
			background-color: rgba(235,235,235,0.7);
		}
		h1.title{
			font-size: 3.5em;
			background-color: rgba(255,255,255,0.5);
			margin-top: 1.2em;
			margin-bottom: 0em;
			letter-spacing: -2px;
		}
		.title{
			font-size: 2.5em;
			background-color: rgba(255,255,255,0.5);
			margin-top: 2em;
			letter-spacing: -2px;
		}
		div.title{
			font-size: 1.8em;
			font-weight: 500;
			background-color: rgba(255,255,255,0.5);
			margin-top:0em;
		}
		.inline-legend-tool-button{	
			color:#666666;
			xxbackground:#ffffff;
			padding:0.4em;
		}
		.navbar-pad-original {
			-moz-box-shadow: 0px 2px 10px /*{global-box-shadow-size}*/ 			rgba(0,0,0,.2) /*{global-box-shadow-color}*/ ;
			-webkit-box-shadow: 0px 2px 10px /*{global-box-shadow-size}*/ 		rgba(0,0,0,.2) /*{global-box-shadow-color}*/ ;
			box-shadow: 0px 2px 10px /*{global-box-shadow-size}*/ 				rgba(0,0,0,.2) /*{global-box-shadow-color}*/ ;
			xxborder-bottom: solid #ddd 1px;
		}
		.shareBtns {
			font-size:8px;
		}
		@media (min-width: 400px) {
			.shareBtns {
				font-size:24px;
			}
		}
		@media (max-width: 400px) {
			body {
				font-size:10px;
			}
			.container {
				margin-top: -1em;
			}
		}
		.title {
			xxfont-family: Roboto,Helvetica;
			color: RGB(148,148,148);
		}
		.sub-title {
			margin-top: -1em;
		}
		h1,h2,h3 {
			margin-top: 0em;
		}
		.data-dynamic{
			font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
		}
		.data-dynamic.btn{
			color: #888888;
			xborder: #888 solid 1px;
			width: 95%;
			font-weight: 500;
			font-size: 2em;
			text-align: left;
			padding: 0.25em 0;
		}
		.data-dynamic.btn:hover{
			color:#83C0D6;
		}
		.summary-theme-button {
			border-left:solid lightgray 5px;
			margin-bottom: 1em;
		}
		.summary-theme-button a{
			text-decoration:none;
		}
		.summary-theme-button a:hover{
			color:#83C0D6;
		}

	</style>

</head>
<body class="story-body">

	<div id="header" class="navbar-fixed-top"  style="position:fixed;top:0;left:-0.5em;width:100%;height:40px;padding:0px 0px 65px 0px;background:#ffffff;z-index:9999" >
		<div class="container" style="margin-top:1.2em" >
			<div class="row">
				<div class="col-lg-8 col-lg-offset-2">
					<div class="header" aria-hidden="true">
						<div class="linkSocialContainer" style="float:left">
							<span class="linkContainer"></span>
							<span class="shareBtns" >
								<a href="javascript:ixmaps.popupShare()">
								<span class="shareIcon fa fa-share fa-fw" title="share actual map" ></span></a>
								<a href="javascript:ixmaps.loadStoryTool('./filter.html',{frame:true})" >
								<i class="shareIcon blackHover share_bitly icon-filter" title="Filter" tabindex="-1" style="margin-left:0.2em" ></i></a>
								<a href="javascript:ixmaps.loadStoryTool('./layer.html')" >
								<i class="shareIcon blackHover share_bitly icon-map" title="Layer" tabindex="-1" style="margin-left:0.2em" ></i></a>
								<a href="javascript:ixmaps.loadStoryTool('./about.html')" >
								<i class="shareIcon blackHover share_bitly icon-info" title="About" tabindex="-1" style="margin-left:0.2em" ></i></a>
								<a href="javascript:ixmaps.loadStoryTool('./menu.html')" >
								<i class="shareIcon blackHover share_bitly icon-list2" title="Menu" tabindex="-1" style="margin-left:0.1em" ></i></a>
								<a href="javascript:ixmaps.loadStoryTool('./table.html',{frame:true})" >
								<i class="shareIcon blackHover share_bitly icon-table2" title="Menu" tabindex="-1" style="margin-left:0.2em" ></i></a>
								<a href="javascript:ixmaps.loadStoryTool('./list.html',{frame:true})"');" >
								<i class="shareIcon blackHover share_bitly icon-insert-template" title="select items on map" tabindex="-1" style="font-size:1.3em;margin-left:0.2em" ></i></a>
								<a href="javascript:ixmaps.embeddedApi.embeddedApi.mapTool('selectrect');" >
								<img src="./resources/images/cursor-select-icon.png" style="height:1.3em;vertical-align:-3px;margin-left:0.2em;opacity:0.4">	
								</a>
							</span>
						</div>
						<div class="linkSocialContainer" style="float:right;margin-right:-0.5em;margin-top:0.2em;">
							<span class="linkContainer"></span>
							<span class="shareBtns" style="font-size:18px">
									<a href="javascript:ixmaps.fullScreen()">
								<i class="shareIcon blackHover share_bitly icon-close" title="Info" tabindex="-1" style="margin-left:0.2em" ></i></a>
							</span>
						</div>
						<div class="logoContainer" style="float:right;margin-right:-10px;display:none">
							<table>
								<tr>
									<td class="logoWrapper">
										<a class="logoLink" target="_blank" tabindex="-1">
											<img class="logoImg" src="" height="60px" style="opacity:0.8"/>
										</a>
									</td>
								</tr>
							</table>
						</div>
					</div>
					<h3 id="italia">&nbsp;<span id="select-misure" style="margin-bottom:1em"></span>
						<span id="data_italia" class="pull-right" style="color:#aaaaaa;font-weight:bold;font-size:0.6em"></span>
					</h3>
				</div>
			</div>
		</div>
	</div>	

	<div id="fullpage" style="margin-top:4em;display:none">

		<div class="section" >

			<!-- incidenti -->

			<div class="slide container"  style="background:rgba(255,255,255,0.8);">
				<div class="intro down">
					<h1 class="title">PNRR TOSCANA</h1>
					<p style="font-size:1.5em;line-height:1em">alcune mappe per esplorare i progetti</p>
					
					<br>
                     <div class="row" style="padding-bottom:0em;margin-left:0em;">
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 summary-theme-button" style="border-color:#60ADD3">
                            <a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_progetti_quad_monitoraggio_geo_prov.json','keepview');$('#monitoraggio-info').show()">
                                <div class="card summary-inline">
                                    <div class="card-body">
                                         <span style="font-size:1.5em">Progetti</span>
                                        <div class="content">
                                            <div id="no_progetti" class="title data-dynamic btn" data-path="data::population::number">--</div>
                                            <div class="sub-title data-dynamic">&nbsp;</div>
                                        </div>
                                        <div class="clear-both"></div>
                                    </div>
                                </div>
                            </a>
                        </div>
					   
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 summary-theme-button">
							<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_importi_symbol_missioni_geo_prov.json','keepview');$('#monitoraggio-info').hide()">
								<div class="card summary-inline">
									<div class="card-body">
										<span style="font-size:1.5em">Importo progetti</span>
										<div class="content">
											<div id="importi" class="title data-dynamic btn" data-path="data::trees::weight">--</div>
											<div class="sub-title data-dynamic">costo dei progetti</div>
										</div>
										<div class="clear-both"></div>
									</div>
								</div>
							</a>
						</div>
					
					</div>	 
					<hr style="margin:0;padding:0;padding-bottom:1em">
                    <div class="row" style="padding-bottom:1em;margin-left:0em;">
					   
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 summary-theme-button">
							<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_finanziati_symbol_missioni_geo_prov.json','keepview');$('#monitoraggio-info').hide()">
								<div class="card summary-inline">
									<div class="card-body">
										 <span style="font-size:1.2em">finanziati </span><span style="font-size:2em">PNRR</span>
										<div class="content">
											<div id="finanziati" class="title data-dynamic btn" data-path="data::trees::co2">--</div>
											<div class="sub-title data-dynamic">finanziati con il PNRR</div>
										</div>
										<div class="clear-both"></div>
									</div>
								</div>
							</a>
						</div>

						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 summary-theme-button">
							<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_pagamenti_symbol_missioni_prov.json','keepview');$('#monitoraggio-info').hide()">
								<div class="card summary-inline">
									<div class="card-body">
										 <span style="font-size:1.2em">pagamenti </span><span style="font-size:2em">SIOPE</span>
										<div class="content">
											<div id="pagamenti" class="title data-dynamic btn" data-path="data::trees::co2/year">--</div>
											<div class="sub-title data-dynamic">pagamenti SIOPE avvenuti</div>
										</div>
										<div class="clear-both"></div>
									</div>
								</div>
							</a>
						</div>
						
						<hr>

					</div>
					

					<p style="font-size:1.5em;line-height:1.3em;margin:0.5em 3em 0em 0em">
						Il <a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_monitoraggio_halfpie_loc.json','keepview');setTimeout('__setFilter()',100);"><b>monitoraggio</b></a> è previsto per <b><span id="no_monitoraggi">...</span></b> progetti ed avviato al <b><span id="percent_monitoraggi">... %</span></b>.</p>
					<p style="font-size:1.5em;line-height:1.3em;margin:0em 5em 0em 0em">
						<b><span id="data_inizio_effettiva">...</span></b> progetti hanno una <a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_tipo_data_inizio_halfpie_loc.json','keepview');setTimeout('__setFilter()',100);"><b>data inizio</b></a> effettiva, pari a <b><span id="data_inizio_effettiva_percent">... %</span></b></p>
					<p><b>scroll down</b> for more visualizations </p>
					<div id="user_legend" style="color:green"></div>
					
					<div>
						<hr>

						<p id="missioni-info" style="margin-top:-0.5em;line-height:0.5em">
							<small style="font-size:0.7em">
							Missioni del PNRR
							<span style="color:#5BBBEB;font-size:50px;vertical-align:-120%" 
							title="M1 - Digitalizzazione, innovazione, competitività, cultura e turismo">&#x2022;</span>
							M1
							<span style="color:#92C151;font-size:50px;vertical-align:-120%" 
							title="M2 - Rivoluzione verde e transizione ecologica">&#x2022;</span>
							M2
							<span style="color:#EA425B;font-size:50px;vertical-align:-120%" 
							title="M3 - Infrastrutture per una mobilità sostenibile">&#x2022;</span>
							M3
							<span style="color:#F49E4B;font-size:50px;vertical-align:-120%" 
							title="M4 - Istruzione e ricerca">&#x2022;</span>
							M4
							<span style="color:#B671DC;font-size:50px;vertical-align:-120%" 
							title="M5 - Inclusione e coesione">&#x2022;</span>
							M5
							<span style="color:#FACB49;font-size:50px;vertical-align:-120%" 
							title="M6 - Sanità territoriale, Innovazione del Servizio sanitario">&#x2022;</span>
							M6
							</small>	
						</p>	
						<p id="monitoraggio-info" style="line-height:0.5em">
							<small style="font-size:0.7em">
							(e visibile on zoom)<br><br>	
							<img src="../../pages/PNRR Toscana Monitoraggio/inlineicons.com_67539_eye-svg-icon-4-2_.svg" height="20px">
							progetto è monitorato
							<img src="../../pages/PNRR Toscana Monitoraggio/progettazione.png" height="20px">
							in progettazione
							<br>
							<img src="../../pages/PNRR Toscana Monitoraggio/started.png" height="15px">
							progetto in esecuzione
							<img src="../../pages/PNRR Toscana Monitoraggio/collaudo.png" height="25px">
							progetto in collaudio
							<br>	
							<img src="../../pages/PNRR Toscana Monitoraggio/515345.png" height="15px">
							progetto terminato
							</small>	
						</p>	
					</div>

				</div>
			</div>

		</div>
		<div class="section">

			<!-- incidenti -->

			<div class="slide container" style="background:rgba(255,255,255,0.8);">
				<div class="intro up down">
					<h1 class="title">Finanziamenti PNRR</h1>
					<p></p>
					<p id="default-legend" class='inline-legend'>
						<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_finanziati_symbol_missioni_geo_prov.json','keepview');">
						<img src="https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/img/tiles/ixmaps_project_PNRR_Toscana_finanziati_symbol_missioni_geo_prov.png" width="45%"><img/>
						</a>	
					</p>
					<p class="click-splash">(click on the image to see the map)</p>
					
				</div>
			</div>

		</div>
	
		<div class="section">

			<div class="slide container" style="background:rgba(255,255,255,0.8);">
				<div class="intro up down">
					<h1 class="title">Monitoraggio</h1>
					<p></p>
					<p class='inline-legend'>
						<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_monitoraggio_halfpie_loc.json','keepview');">
						<img src="https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/img/tiles/ixmaps_project_PNRR_Toscana_monitoraggio_halfpie_loc.png" width="45%"><img/>
						</a>	
					</p>
				</div>
			</div>

		</div>

		<div class="section">

			<div class="slide container" style="background:rgba(255,255,255,0.8);">
				<div class="intro up down">
					<h1 class="title">Data inizio</h1>
					<p></p>
					<p class='inline-legend'>
						<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_tipo_data_inizio_halfpie_loc.json','keepview');">
						<img src="https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/img/tiles/ixmaps_project_PNRR_Toscana_tipo_data_inizio_halfpie_loc.png" width="45%"><img/>
						</a>	
					</p>
				</div>
			</div>

		</div>

		<div class="section">

			<div class="slide container" style="background:rgba(255,255,255,0.8);">
				<div class="intro up down">
					<h1 class="title">Avanzamento & progetti</h1>
					<p></p>
					<p class='inline-legend'>
						<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_progetti_quad_avanzamenti_monitoraggio_geo_grid.json','keepview');">
						<img src="https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/img/tiles/ixmaps_project_PNRR_Toscana_progetti_quad_avanzamenti_monitoraggio_geo_grid.png" width="45%"><img/>
						</a>	
					</p>
				</div>
			</div>

		</div>

		<div class="section">

			<div class="slide container" style="background:rgba(255,255,255,0.8);">
				<div class="intro up down">
					<h1 class="title">Avanzamento & valori</h1>
					<p></p>
					<p class='inline-legend'>
						<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_progetti_missioni_avanzamento.json','keepview');">
						<img src="https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/img/tiles/ixmaps_project_PNRR_Toscana_progetti_missioni_avanzamento.png" width="45%"><img/>
						</a>	
					</p>
				</div>
			</div>

		</div>

		<div class="section">

			<div class="slide container" style="background:rgba(255,255,255,0.8);">
				<div class="intro up down">
					<h1 class="title">Avanzamento</h1>
					<p></p>
					<p class='inline-legend'>
						<a href="javascript:ixmaps.map().loadProject('https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_progetti_missioni_avanzamento_halfpie_grid.json','keepview');">
						<img src="https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/img/tiles/ixmaps_project_PNRR_Toscana_progetti_missioni_avanzamento_halfpie_grid.png" width="45%"><img/>
						</a>	
					</p>
				</div>
			</div>

		</div>


		<div class="section">

			<div class="slide container">
				<div class="intro up down">
					<h1 class="title">Used Data</h1>
					<br>
					<h3>shapes</h3>
					<br>
					<h4>Confini amministrativi</h4>
					Pubblicati dall'ISTAT 
					<a href="https://www.istat.it/it/archivio/222527" target="_blank"> qui </a> CC BY 4.0
					
					<br><br>

					
					<h3>data</h3>
					<br>
					<h4>Progetti PNRR</h4>
					Pubblicato dalla Regione Toscna come Open Data
						<a href="https://dati.toscana.it/dataset/regione-toscana-pnrr" target="_blank">qui</a>
					
					<br>
					</p>
				</div>
			</div>

		</div>

		<div class="section">
			<div class="intro footer up">
				<br>
				<br>
				<br>
				<br>
				<h2>Attributions</h2>
				<br>
				<br>
				<p>Data:<br>
				<a href='https://dati.toscana.it/dataset/regione-toscana-pnrr' target='_blank'>Open Data - Regione Toscna - CC BY 4.0</a></p>
				<br>
				<p>Visualization:<br>
				created by <a href="http://ixmaps.com">iXmaps</a> - CC BY</p>
				<br>
				<p>credits</p>
				<p>
					<a href="http://alvarotrigo.com/fullPage/">alvarotrigo.com</a> - for the scrolling
				<br><a href="http://icomoon.io">icomoon.io</a> - for the nice icons
				</p>

			</div>
		</div>

	</div>


	<!-- ==== MODAL DIALOG ==== -->
	<div id="modal-dialog-1" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="z-index:9999">
	  <div class="modal-dialog modal-lg">
		  <div class="modal-content">
			...
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		  </div>
	  </div>
	</div>
	<div id="modal-dialog-2" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="z-index:9999">
	  <div class="modal-dialog modal-lg">
		  <div class="modal-content">
			...
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		  </div>
	  </div>
	</div>
	<div id="modal-dialog-3" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="white;z-index:9999">
	  <div class="modal-dialog modal-lg">
		  <div class="modal-content">
			...
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		  </div>
	  </div>
	</div>

	<!--[if IE]>
		<script type="text/javascript">
			 var console = { log: function() {} };
		</script>
	<![endif]-->

 	<script type="text/javascript" src="assets/plugins/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="assets/js/main.js"></script>
	<script type="text/javascript" src="assets/js/masonry.pkgd.min.js"></script>
	<script type="text/javascript" src="assets/js/imagesloaded.js"></script>
    <script type="text/javascript" src="assets/js/classie.js"></script>
	<script type="text/javascript" src="assets/js/AnimOnScroll.js"></script>

	<script type="text/javascript" src="assets/plugins/scrolloverflow.js"></script>

	<script type="text/javascript" src="assets/plugins/jquery.fullPage.min.js"></script>

    <script type="text/javascript" src="https://gjrichter.github.io/data.js/data.js"></script>

	<script type="text/javascript">

 		// --------------------------------
		// get ixmaps API from parent 
		// --------------------------------
		
		var ixmaps = null;
		if ( window.opener ){
			ixmaps = window.opener.ixmaps;
		}else
		if ( parent ){
			ixmaps = parent.window.ixmaps;
		}
		else{
			alert("error: missing parent window for themes !");
		}

		ixmaps.initialized = false;

		// do not synchronise multiple map frames
		ixmaps.setSyncMultiMaps(false);

		var nLegendDiv = 0;
		var legendA = Array(0);
		ixmaps.setLegendDiv = function(n){
			nLegendDiv = n;
		};

		ixmaps.setLoading = function(){
			ixmaps.showLoading("... caricando ...");
		};

		// --------------------------------
		// p a g e 
		// --------------------------------

		// enumerate sections, slides and theme
		// and create the right ids for fullpage slide handling
		// -----------------------------------------------------
		var section = 0;
		$(".section").each(function(){
			$(this).attr("id","section"+(++section));
			var slide = 0;
			$(this).find(".slide").each(function(){
				$(this).attr("id","section"+section+"slide"+(++slide));
				$(this).find(".theme").each(function(){
					$(this).attr("id","theme_"+section+""+slide);
				});
			});
		});

        // CUSTOM SCROLL SCRIPT FUNCTION FOR NAVBAR
        $(function () {
            $('.scrollclass a').bind('click', function (event) { //just pass scrollclass in design and start scrolling
                var $anchor = $(this);
                $('html, body').stop().animate({
                    scrollTop: $($anchor.attr('href')).offset().top
                }, 1000, 'easeInOutQuad');
                event.preventDefault();
            });
        });
       //ADD REMOVE PADDING CLASS ON SCROLL
        $(window).scroll(function () {
            if ($(document).scrollTop() > 40) {
                $(".navbar-fixed-top").addClass("navbar-pad-original");
            } else {
                $(".navbar-fixed-top").removeClass("navbar-pad-original");
            }
        });

		var html = '<a href="javascript:$.fn.fullpage.moveSectionDown();"><div class="row scrollclass fp-controlArrow fp-down" style="left:'+(window.innerWidth/2-33)+'px;top:'+(window.innerHeight-100)+'px;text-align:center;margin-top:-0.7em;margin-bottom:1em;"></div></a>';
		$('.down').append(html);

		var html = '<a href="javascript:$.fn.fullpage.moveSectionUp();"><div class="row scrollclass fp-controlArrow fp-up" style="left:'+(window.innerWidth/2-33)+'px;top:'+(window.innerHeight-100)+'px;text-align:center;margin-top:-2.2em;margin-bottom:3em;margin-left:1em"></div></a>';
		$('.up').append(html);

		$(document).ready(function() {

			var __section = null;
			var __slide = null;
			var __fMoveActive = false;

			var __onChange = function() {
				
				if ( !ixmaps.initialized ){
					setTimeout("ixmaps.onChange()",100);
					return;
				}
				if ( ixmaps.fMoveToSection ){
					ixmaps.fMoveToSection = false;
					return;
				}
				__doTheme("theme_"+__section+(__slide+1));	
			};

			ixmaps.onChange = function(){
				__onChange();
			};
			
			$('#fullpage').fullpage({
				'scrollOverflow': true,
				'scrollOverflowOptions':{
					scrollbars:false
				},
				'verticalCentered': false,
				'css3': true,
				//'sectionsColor': ['#888888', '#4A6F81', '#B14A4A'],
				'navigation': true,
				'navigationPosition': 'right',
				'navigationTooltips': ['Incidenti', 'Analisi temporali', 'Pericolosità', 'Natura del incidente','Attribuzioni'],

				'afterLoad': function(a,index,c,d){
					__section = index;
					__slide = 0;
					$.fn.fullpage.silentMoveTo(index, __slide);
				},
				'afterSlideLoad': function(a,index,c,d){
					__slide = d;
					__onChange();
				},

				'onLeave': function(index, nextIndex, direction){
				}
			});
			$('#fullpage').fadeIn( "slow");
		});

		__doThemeOldTheme = null;
		__doThemeTimeout = null;
		__doTheme = function(szName) {
			
			if ( szName == __doThemeOldTheme ){
				return;
			}
			__doThemeOldTheme = szName;
			if ( __doThemeTimeout ){
				clearTimeout(__doThemeTimeout);
			}
			__doThemeTimeout = setTimeout("__doThemeOnTimeout('"+szName+"')",100);
		}
		__doThemeOnTimeout = function(szName) {
			$("#"+szName).click();
			eval($("#"+szName).attr("href"));
		}

		// ------------------------------
		// set resize handler
		// ------------------------------
		$( window ).resize(function() {
			// refresh scrollspy !!!
			$('[data-spy="scroll"]').each(function () {  
			  var $spy = $(this).scrollspy('refresh')  
			});  
		});


		// --------------------------------------------------------------
		// define click extension to
		// check/highlight the theme button 
		// --------------------------------------------------------------

		// array to store the clicked objects for onRemoveTheme callback
		var clickA = new Array(0);

		// store the last clicked object for onNewTheme callback
		var lastClicked = null;
		$("a").click(function () {
			if ( String($(this).attr("href")).match(/newtheme/i) ||
				 String($(this).attr("href")).match(/loadProject/i)
			   ){
				lastClicked = $(this);
			}
		});

		// -----------------------------------
		// adapt legend background to map type
		// -----------------------------------

		/**
		 * set legend background on map type change
		 * @type void
		 */
		__changeCss = function(className, classValue) {

			var cssMainContainer = $('#css-modifier-container');
			if (cssMainContainer.length == 0) {
				var cssMainContainer = $('<style id="css-modifier-container"></style>');
				cssMainContainer.appendTo($('head'));
			}
			cssMainContainer.append(className + " {" + classValue + "}\n");
		};

		ixmaps.htmlgui_setMapTypeBG = function(szId){

			$("#css-modifier-container").remove();

			if ( szId.match(/dark/i) || szId.match(/black/i) ){
				__changeCss(".story-body", "background-color:rgba(25,25,25,0.3)");
				__changeCss(".inline-legend", "background-color:rgba(25,25,25,0.7)");
				__changeCss(".title", "background-color:rgba(25,25,25,0.7)");
			}else{
				__changeCss(".body-story", "background-color:rgba(255,255,255,0.1)");
				__changeCss(".inline-legend", "background-color:rgba(255,255,255,0.5)");
				__changeCss(".title", "background-color:rgba(255,255,255,0.5)");
			}
		};


		// define some helper for the sidebar menu

		ixmaps.moveSectionsDown = function(nr){
			nr = nr || 1;
			for ( var i=0; i<nr; i++ ){
				setTimeout("$.fn.fullpage.moveSectionDown();",i*100);
			}
		};

		ixmaps.moveToSection = function(nr,slide){
			ixmaps.fMoveToSection = true;
			$.fn.fullpage.silentMoveTo(nr,slide);
		};

		ixmaps.moveSlideRight = function(nr){
			nr = nr || 1;
			for ( var i=0; i<nr; i++ ){
				setTimeout("$.fn.fullpage.moveSlideRight();",i*100);
			}
		};

		// load themes script
		// and initialize map if all loaded
		//
		$.when(
			$.getScript( "./index.js" ),
			$.getScript( "./facet.js" ),
			$.getScript( "./inline_legend.js" ),
			$.Deferred(function( deferred ){
				$( deferred.resolve );
			})
		).done(function(){
			// ------------------------------
			// initialize map
			// ------------------------------

			ixmaps.waitForMap(null, function(map) {
				
				ixmaps.initialized = true;

				map.setMapTypeId("white");
				
				map.setLocalString("... processing ...", "");
				map.setLocalString("... creating theme ...", "");
				map.setLocalString("cleaning up ...", "");
				map.setLocalString("processing data ...", "&#9881;");
				
				map.setLocalString("loading data ...", "data &#x2B73;");
				map.setLocalString("aggregated", "&#9881;");
				map.setLocalString("please wait ...", "&#9881;");
				map.setLocalString("drawing", "&#9881;");
				map.setLocalString("do selection", "");
				map.setLocalString("...", "");

				mymap = map;
				
				map.view([43.398063077901604,11.065979003906252],9);
				map.loadProject("https://raw.githubusercontent.com/gjrichter/viz/master/PNRR/projects/ixmaps_project_PNRR_Toscana_progetti_quad_monitoraggio_geo_prov.json","keepview");
				
			});

		}).fail(function(){
			alert("script loading "+arguments[2].toString());
		});

	</script>


</body>
</html>
